%     aa.dem
% AA vers. 9.1, LaTeX class for Astronomy & Astrophysics
% demonstration file
%                                                       (c) EDP Sciences
%-----------------------------------------------------------------------
%
%\documentclass[referee]{aa} % for a referee version
%\documentclass[onecolumn]{aa} % for a paper on 1 column
%\documentclass[longauth]{aa} % for the long lists of affiliations
%\documentclass[letter]{aa} % for the letters
%\documentclass[bibyear]{aa} % if the references are not structured
%                              according to the author-year natbib style

%
\documentclass[twocolumn]{aa}

%
\usepackage{graphicx}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{txfonts}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\usepackage[options]{hyperref}
% To add links in your PDF file, use the package "hyperref"
% with options according to your LaTeX or PDFLaTeX drivers.
%
\hbadness=99999
\begin{document}


   \title{Modelling the formation of the GD-1 stellar stream inside a host with a fermionic dark matter core-halo distribution.}

   % \subtitle{I. Overviewing the $\kappa$-mechanism}

   \author{Martín F. Mestre\inst{1,2}\fnmsep\thanks{
         \email{mmestre@fcaglp.unlp.edu.ar}
      }
      \and
      Carlos R. Argüelles\inst{1,2}
      \and
      Daniel D. Carpintero\inst{1,2}
   }

   \institute{Instituto de Astrof{\'i}sica de La Plata (CONICET-UNLP), Paseo del
               Bosque S/N, La Plata (1900), Buenos Aires, Argentina\\
               \and
              Facultad de Ciencias Astron{\'o}micas y Geof{\'i}sicas de La Plata (UNLP),
              Paseo del Bosque S/N, La Plata (1900), Buenos Aires, Argentina\\
             }

   \date{Received February 29, 2023; accepted February 30, 2023}

% \abstract{}{}{}{}{}
% 5 {} token are mandatory

  \abstract
  % context heading (optional)
  % {} leave it empty if necessary
   {Stellar streams are a consequence of the tidal forces produced by a host galaxy on its satellites (i.e. globular clusters and dwarf spheroidals).
   As the self-gravity of stellar streams is almost negligible, they constitute excellent probes of the gravitational potential of the host galaxy. For this reason, some Milky Way stellar streams have been used to put constraints on the dark matter (DM) total mass and shape, under empirical DM distributions (i.e. NFW, logarithmic, etc). Within the set of non-empirical DM distributions, there exists a DM model
   deduced from first principles by means of the maximization of the coarse-grained entropy for self-gravitating fermions, the MEPP, after Maximum Entropy Production Principle. MEPP profiles have a rich
   variety of behaviours, being a large subfamily characterized by a dense core of mass
   $\approx4.1\times10^6 M_\odot$ (that can mimick a black hole regarding the orbits of the S-stars at Sagittario A*) and an extended halo with the plasticity of a Burkert profile.}
  % aims heading (mandatory)
   {In this work we attempt to model the GD-1 stellar stream using a spherical MEPP distribution which, at the same time, is in sintony with previous fits to the S-stars.}
  % methods heading (mandatory)
   {For that purpose we used a genetic algorithm in order to fit both the stream orbit's initial conditions and the fermionic halo. We modelled the barionic potential with a bulge and two disks (thin and thick) with fixed parameters according to the recent literature. The stream observable is 6D phase-space data from the Gaia DR2 survey.}
  % results heading (mandatory)
   {We were able to find good fits for a 1D continuous subfamily of models parametrized by the fermion
   mass going from $56$~keV/$c^2$ to $~360$~keV/$c^2$, respectively corresponding to core radii going from
   $10^3$ to 10 Schwarzschild radii. For smaller and larger values of the fermion mass, there is no solution that simultaneously fits the GD-1 stream and the S-stars. The solutions have a virial radius of 28 kpc and a virial mass of $1.4\times10^{11} M_\odot$, the latter being at $2\sigma$ from previous Milky Way DM halo mass estimates using the Sagittarius stream. We do not assume the velocity of the local standard of rest ($v_\mathrm{lsr}$) and the result gives $v_\mathrm{lsr}\approx244$ km/s, in agreement with recent independent estimates.}
  % conclusions heading (optional), leave it empty if necessary
   {}

   \keywords{Galaxy: kinematics and dynamics --
             Galaxy: stellar streams --
             dark matter
               }
   \titlerunning{The GD-1 stream inside a fermionic dark matter halo.}

   \maketitle
%________________________________________________________________

\section{Introduction}

Stellar streams probe the acceleration field produced by the Milky Way (MW).
This information together with barionic measurements help in making claims about the
dark matter (DM) halo.

\section{Methodology}
In this section we explain the observables and methods used in this research.
The exact pipeline applied in order to obtain the results and plots of this paper
can be found at the following GitHub repository:
\url{https://github.com/martinmestre/stream-fit/blob/main/pipeline_paper/}.

\subsection{Observables and assumed measurements}
\label{sec:observables}

The main observables used in this project are materialized by the polynomial fits performed by
\citet{Ibata_2020} on the GD-1\\ stream using astrometry (Gaia DR2), photometry and high-precision spectroscopy datasets together with the analysis of the {\sc streamfinder} algorithm.
Those polinomials are the following:
\begin{eqnarray}
   \label{Ibata_polyn}
   \phi_2  &=& 0.008367\phi_1^3-0.05332\phi_1^2-0.07739\phi_1-0.02007, \\
   D &=& -4.302\phi_1^5-11.54\phi_1^4-7.161\phi_1^3 +5.985\phi_1^2 \nonumber\\
      &&+ 8.595\phi_1+10.36,\\
   \tilde{\mu}_\alpha &=& 3.794\phi_1^3+9.467\phi_1^2+1.615\phi_1-7.844,\\
   \mu_\delta &=& -1.225\phi_1^3+8.313\phi_1^2+18.68\phi_1-3.95,\\
   v_h &=&  90.68\phi_1^3+204.5\phi_1^2-254.2\phi_1-261.5,\\
   \label{Ibata_polynb}
\end{eqnarray}
with $\phi_1$ and $\phi_2$ in radians, $D$ in kpc, $\tilde{\mu}_\alpha=\mu_\alpha cos \delta$ and $\mu_\delta$ in mas/yr and $v_h$ in km/s. These quantities correspond respectively to longitude and latitude in GD-1 celestial frame of reference~\citep{Koposov_2010}, heliocentric distance, proper motion in right ascension and declination, and heliocentric radial velocity.
The domain of this polinomials is limited to $-90<\phi_1[^\circ]<10$.
To have our observable data points we sample the domain with 100 points ($\phi_1^{(i)}$ for $i=1,...,100$)
and evaluate the polinomials there in order to have a complete set of observables ($\phi_1^{(i)}$, $\phi_2^{(i)}$, $D^{(i)}$, $\tilde{\mu}_\alpha^{(i)}$, $\mu_\delta^{(i)}$, $v_h^{(i)}$).
In one of the experiments we will consider an observable of a different nature
and related to the density concentration at the origin, of size $\lesssim 1$ milliparsec,
characteristic of the fermionic halo distribution. By convention, the core radius is defined
as the radius when the circular velocity reaches its first maximum.
The constraint for the mass of the core of the distribution is assumed to be $m_{\rm{core}}=3.5\times10^6 M_\odot$ in agreement with~\citet{2020A&A...641A..34B,2021MNRAS.505L..64B,2022MNRAS.511L..35A}.

The assumed measurements used in this paper are the
galactocentric distance of the sun $R_\odot=8.122$ kpc~\citep{2018A&A...615L..15G} and the sun's peculiar
velocity $\boldsymbol{v}_{\odot p} = (11.1, 12.24, 7.25)$ km/s~\citep{Shonrich}.


\subsection{The fermionic DM model}
Our DM model consists of a spherical and isotropic distribution of fermions at finite temperature in hydrostatic equilibrium subject to the law of General Relativity (GR), i.e. T.O.V equations, as defined in~\cite{arguelles_novel_2018} with the particularity that we have made a few change of variables in order to make the numerical computation more robust. The system of equations thus obtained is as follows:

\begin{eqnarray}
   \label{sode}
   \frac{d\nu}{d\zeta} & = & \frac{1}{2}\left[e^{z}+e^{2\zeta}\frac{P(r)}{\rho_{rel}c^2}\right][1-e^{z}]^{-1},\\
   \frac{dz}{d\zeta} & = &-1+e^{(2\zeta-z)}\frac{\rho(r)}{\rho_{rel}},
\end{eqnarray}
where
\begin{eqnarray}
   \zeta &=& \ln(r/R),\\
   z &=&\ln\psi,\quad \psi = \frac{M_{\rm{DM}}(r)}{M}\frac{R}{r},\label{mass_dm}\\
   \rho(r)&=&\frac{4\rho_{\rm rel}}{\sqrt{\pi}}\int^\infty_1\epsilon^2[\epsilon^2-1]^{1/2}f(r,\epsilon)d\epsilon,\\
   P(r)&=&\frac{4\rho_{\rm rel}c^2}{3\sqrt{\pi}}\int^\infty_1[\epsilon^2-1]^{3/2}f(r,\epsilon)d\epsilon,\\
   R^2 &=& \frac{c^2}{8\pi G \rho_{\rm{rel}}},\\
   M &=& 4\pi R^3 \rho_{\rm{rel}},\\
   \rho_{\rm{rel}}&=& \frac{ G\pi^{3/2} m^4 c^3}{h^3},
\end{eqnarray}
where $G$ is the Gravitational constant, $c$ is the speed of light, $h$ is the Planck constant, $m$ is the fermion mass, $M_{\rm{DM}}(r)$ is DM mass enclosed up to radius $r$, $\rho(r)$ is the density, $P(r)$ is the pressure and $\nu(r)$ is the metric exponent, i.e. we use the convention $g_{00}=e^{\nu(r)}$. The phase-space function ($f$) is given by a Fermi-Dirac distribution with energy cutoff:
\begin{equation}
f(r,\epsilon)=
   \begin{cases}
      \frac{\displaystyle{1-e^{[\epsilon-\epsilon_c(r)]/\beta(r)}}}
      {\displaystyle{1+e^{[\epsilon-\alpha(r)]/\beta(r)}}}\quad \epsilon \leq \epsilon_c(r)\\
      0\quad \epsilon > \epsilon_c(r),
   \end{cases}
\end{equation}
where $\alpha(r)$ is the chemical potential (including rest mass), $\epsilon_c(r)$ is the cutoff
energy (including rest mass) and $\beta(r)$ is the temperature variable.

The above equations should be complemented with two thermodinamic equilibrium conditions given
in~\citet{PhysRev.35.904} and~\citet{RevModPhys.21.531} together with the condition of energy conservation
along the geodesic given in~\citet{1989A&A...221....4M}:
\begin{equation}
   \frac{1}{\alpha}\frac{d\alpha}{dr}=\frac{1}{\beta}\frac{d\beta}{dr}=
   \frac{1}{\epsilon_c}\frac{d\epsilon_c}{dr}=-\frac{1}{2}\frac{d\nu}{dr}.
   \label{geod_energy}
\end{equation}

It is not possible to integrate this equations from $r=0$ because the right hand the change of variables $\zeta(r)$ is divergent at the origin. Nevertheless, it is possible
to reach the following approximations for the initial conditions at a value $r_{\rm{min}}\gtrsim 0$:
\begin{eqnarray}
   \nu(r_{\rm{min}}) &\approx& \frac{1}{6}\frac{\rho_0}{\rho_{\rm{rel}}}\left[\frac{r_{\rm{min}}}{R}\right]^2\equiv\tau, \\
   \psi(r_{\rm{min}})&\approx&\frac{1}{3}\frac{\rho_0}{\rho_{\rm{rel}}}\left[\frac{r_{\rm{min}}}{R}\right]^2=2\tau,
\end{eqnarray}
which implies
\begin{equation}
   \frac{r_{\rm{min}}}{R}=\sqrt{6\tau\frac{\rho_{\rm{rel}}}{\rho_0}},
\end{equation}
where $\rho_0\equiv \rho(0)$.
It can be seen that the right hand side of Eq.~\ref{sode} does not depend on the metric so we can add
a constant $\nu_0$ to the solution in order to satisfy a condition of continuity with the Schwarzschild metric at the border of the fermion distribution, obtaining:
$$\nu_0 = 2\ln\left(\frac{\beta_b}{\beta_0}\sqrt{1-\psi_b}\right),$$
where $\psi_b$ and $\beta_b$ are quantities evaluated at the border.

The system of equations thus obtained has four free parameters: $m$, $\alpha_0=\alpha(0)$,
$\beta_0=\beta(0)$, and $\epsilon_{c0}=\epsilon_c(0)$ but in practice we will use the following related
quantities as parameters:
$m$, $\beta_0$, $\theta_0=(\alpha_0-1)/\beta_0$, and $W_0=(\epsilon_{c0}-1)/\beta_0$.

Equations~\ref{sode}-\ref{geod_energy} are solved using
a {\sc Python}~\citep{van1995python} script\footnote{\texttt{model\_def.py}}
that makes use of the {\it NumPy}~\citep{2020SciPy-NMeth} and {\it SciPy}~\citep{harris2020array} libraries. We tried all the solvers available in the latter package but the only one that
could properly integrate these equations was the \texttt{LSODA} algorithm. We used relative and absolute tolerance parameters respectively given by \texttt{rtol}$=5\times10^{-14}$ and \texttt{atol}$=0$.


\subsection{Milky Way and stream models}
\label{sec:MW_stream_models}

We model our Galaxy with a combination of the fermionic dark halo recently described, whose parameters will be determined in this work, plus a barionic component fixed and identical to the one in Model I of~\citet{2017A&A...598A..66P}. Here we name this full Galaxy model as Fermionic-MW.

Appart from our model, for some intermediary tasks, we will make use of the Galactic model fitted
by~\citet{2019MNRAS.486.2995M} which consists in the {\texttt{MWPotential2014}}
model with an axisymmetric NFW profile. This fitted model corresponds to a circular velocity at the position of the sun of
$v_c(R_\odot)=244 \pm 4 \rm{ km s}^{-1}$ and a $z-$flattening of the DM density distribution of $q_\rho=0.82^{+0.25}_{-0.13}$. Here we name this Galaxy model as NFW-MW.

As GD-1 is a dynamically cold stream, with its stars keeping a large degree of correlation, its almost
one-dimensional distribution in phase-space can be well approximated with the orbit of its progenitor.
Another facts in this direction, are that there has not been any observation of the tidal arms feature
nor of the progenitor's position~\citep{2019MNRAS.486.2995M,10.1093/mnras/sty677,10.1093/mnras/sty1338,Price-Whelan_2018}.

In the code, the orbit model is computed starting from initial conditions in spherical equatorial coordinates, ICRS frame: $\alpha$ (RA), $\delta$ (declination), $D$, $\tilde{\mu}_\alpha$, $\mu_\delta$, $v_h$.
The code uses the {\it Astropy} ecosystem~\citep{astropy:2022, astropy:2018, astropy:2013} in order to transform the initial condition to galactocentric coordinates assuming a Galactocentric reference frame with the sun at the position $\boldsymbol{x}_\odot=(-R_\odot,0,0)$ and a sun's velocity given by the sum of the circular velocity at the position of the sun and
the sun's peculiar velocity: $\boldsymbol{v}_\odot=(11.1, v_c(R_\odot)+12.24, 7.25)$. The circular velocity is dependent on the model and the position and given by

\begin{eqnarray}
   v_c^2(R_\odot)&=& R_\odot||\nabla \Phi(\boldsymbol{x})||_{\boldsymbol{x}=\boldsymbol{x}_\odot}\nonumber\\
   &=& R_\odot||\nabla \Phi_{\rm{B}}(\boldsymbol{x})||_{\boldsymbol{x}=\boldsymbol{x}_\odot}+
   G \frac{M_{\rm{DM}}(R_\odot)}{R_\odot},
\end{eqnarray}
where $\Phi$ is the total potential, $\Phi_B$ is the potential generated by the three barionic components and $M_{\rm{DM}}(r)$ was defined in Eq.~(\ref{mass_dm}). We have used the spherical symmetry property of the DM distribution in order to relate the acceleration with the enclosed mass.

A second step is to integrate the orbit forwards and backwards in time during a time interval of $\Delta t=0.2$ Gyr, starting in both cases from a given initial condition for the progenitor. In the next sections
we will explain how this initial condition was chosen for some simulations and fitted for others. The integrator used is a Runge-Kutta of order eight (\texttt{DOP853} called from {\it SciPy}'s \texttt{solve\_ivp} function) with relative and absolute tolerance parameters respectively given by
\texttt{rtol}$=5\times10^{-14}$ and \texttt{atol}$=0.5\times10^{-14}$.

After having the stream's orbit integrated, we transform the orbit to both the ICRS and the GD-1 frame of coordinates. For the latter we used the \texttt{GD1Koposov10} class defined in the Gala package~\citep{gala,adrian_price_whelan_2020_4159870} which uses the transformation matrix defined
by~\citet{Koposov_2010}.
After these two transformation we obtain the orbit expressed in the observable variables ($\phi_1$, $\phi_2$, $D$, $\tilde{\mu}_\alpha$, $\mu_\delta$, $v_h$) used in Eqs.~(\ref{Ibata_polyn})-(\ref{Ibata_polynb}).
Finally, we build interpolators of these variables as a function of $\phi_1$ that will be used, together with the observed data defined in Sec.~\ref{sec:observables}, to evaluate the following $\chi^2$ stream function:
\begin{eqnarray}
   \label{chi2}
   \chi^2_{\rm{stream}} &=& \chi^2_{\phi_2} + \chi^2_{D}+ \chi^2_{\tilde{\mu}_\alpha}+ \chi^2_{\mu_\delta}+\chi^2_{v_h},\\
   \chi^2_{\eta} &=& \frac{1}{\sigma_\eta^2}\sum_{i=1}^{100} \Big(\eta^{(i)}-\eta(\phi_1^{(i)})\Big)^2,
\end{eqnarray}
where
$\eta$ represents each of the four corresponding independent variables ($\phi_2$, $D$, $v_h$, $\tilde{\mu}_\alpha$, $\mu_\delta$) and $\sigma_\eta$ is the average dispersion of the stream data points taken by
ocular inspection from Figs.~1,3,4 of~\citet{Ibata_2020}:
$\sigma_{\phi_2}=0.5^\circ$,
$\sigma_{D}= 1.5~\rm{kpc}$,
$\sigma_{v_h} = 10~\rm{km/s}$ and
$\sigma_{\tilde{\mu}_\alpha}= \sigma_{\delta}= 2~\rm{mas/yr}$.
Thus $\chi^2_{\rm{stream}}$ measures the departure of the model from the stream observations.
For some fits we will also consider the departure of the model from a dark mass constraint in the core
of the distribution:
\begin{equation}
   \label{m_core}
   \chi^2_{\rm{core}}=\frac{(m-m_{\rm{core}})^2}{\sigma_m^2},
\end{equation}
where $m_{\rm{core}}$ was defined in Sec.~\ref{sec:observables} and
$\sigma_m$ was fixed in 1\% of $m_{\rm{core}}$, so sometimes we will use the following compound function:
\begin{equation}
   \label{chi2_full}
   \chi^2_{\rm{full}}=\chi^2_{\rm{stream}}+\chi^2_{\rm{core}}.
\end{equation}

Note that in order to compute the estimated core mass of each model, $m$ in Eq.(\ref{m_core}),
we must find the first local maximum of the expression for the circular velocity in GR:
\begin{equation}
   \label{v_circ_dm}
   v_{\rm{DM}}(r)= c\sqrt{\frac{r}{2}\frac{d\nu(r)}{dr}}.
\end{equation}

\subsection{Optimization algorithms}
\label{sec:optimization}

Our objective consists in fitting our MW model by minimizing the $\chi^2$ function given by Eqs.~(\ref{chi2},\ref{chi2_full}).  In order to do so we use two optimization algorithms for different purposes
that will be explained in Sec.~\ref{sec:results}.
One of them is {\it SciPy}'s
\texttt{optimize.differential\_evolution} algorithm. This genetic architecture
was used with metaparemeters given by
\texttt{strategy}=\texttt{"best2bin"}, \texttt{maxiter}=200, \texttt{popsize}=200,
\texttt{tol}=$5\times10^{-8}$ and \texttt{atol}=0, unless otherwise stated. This method can be run in parallel with shared memory,
so a convergence test was made in a cluster's node with 24 processors, varying the values of the metaparameters (e.g. halving and doubling the values of \texttt{maxiter} and \texttt{popsize}, setting \texttt{strategy}=\texttt{"best1bin"} and combinations).

The other algorithm is \texttt{LN\_NELDERMEAD}~\citep{NELDERMEAD,10.1093/comjnl/8.1.42,shere} from the
{\it NLopt.jl}~\citep{NLopt} package
for the {\sc Julia}~\citep{bezanson2017julia} language.
We used default values for the all its metaparameters except for
\texttt{reltol}=$5\times10^{-5}$.



\section{Results and discussion}
\label{sec:results}

Initially, we searched for a good enough initial condition (IC) of the progenitor orbit for our
Fermionic-MW. For that, we fitted the initial conditions in the (fixed) NFW-MW model defined in
Sec.~\ref{sec:MW_stream_models} by using the $\chi^2_{\rm{stream}}$ function defined in Eq.~(\ref{chi2})
and the genetic algorithm specified in Sec.~\ref{sec:optimization}. The genetic algorithm
needs to be provided with bounds for the variables so we used boxes with a centre close to the middle point
of the observable data, i.e. $\eta^{(51)}$ that corresponds to $\alpha=149.24^{\circ}$, $\delta=36.61^{\circ}$, $D=7.69$ kpc, $\tilde{\mu}_\alpha=-5.70$ mas/yr, $\mu_\delta=-12.48$ mas/yr and $v_h=-18.81$ km/s, and with generous sides of length equal to their absolute values (except for $\alpha$ where we used a side of lenght $\alpha/5$).

It should be said that the NFW-MW model was fitted by~\citet{2019MNRAS.486.2995M} with a set of Gaia
DR2 data different from the polynomials used here. Any point along the stream is equally good as an IC. The genetic algorithm converged to a solution given approximately by
$\alpha=149.17^{\circ}$, $\delta=36.51^{\circ}$, $D=7.95$ kpc, $\tilde{\mu}_\alpha=-6.94$ mas/yr, $\mu_\delta=-12.49$ mas/yr and $v_h=-18.33$ km/s with a value of $\chi^2_{\rm{stream}}\approx 17.52$.
The orbit that corresponds to this IC is displayed in the observable space in Fig.~\ref{fig:obs_pos}~(top: $\phi_2$, bottom: $D$) and Fig.~\ref{fig:obs_vel}~(top: $\tilde{\mu}_\alpha$, middle: $\mu_\delta$, bottom: $v_h$) with a dashed yellow line. The thick solid black line shows the corresponding observable $\eta$ data
while the thin solid ones demarkate the corresponding regions at $1\sigma_\eta$.

From previous works~\citep{arguelles_novel_2018,2019PDU....24..278A,2023ApJ...945....1K} we know that the fermionic DM model parameters can be approximately grouped in two sets with different functionality. One group is formed
by $\epsilon$ and $\beta_0$ that control the core of the distribution in the sense that
for given values of $m_{\rm{core}}$ (Sec.~\ref{sec:observables}) and $\epsilon$, it is possible to find a value of $\beta_0$ in agreement; with a very small influence of the other two parameters: $\theta_0$ and $W_0$. This implies a partial degeneracy between $\epsilon$ and $\beta_0$.
The other group is formed by $\theta_0$ and $W_0$, which have small effect on the core region but
determine the distribution behaviour in the halo region. Additionally, there is also an approximate
degeneracy between these two variables in the sense that it is the parameter
$\omega_0 = W_0-\theta_0$ which mainly controls the halo profile, as will be further shown in this paper.

As a starting point for our ¿?-step multiparameter search, we took the result from~\citet{2020A&A...641A..34B} who found that for $(\epsilon, \beta_0, \theta_0, W_0)=(56, 1.1977\times10^{-5}, 37.765, 66.3407)$
their MW model (DM+barions) satisfies both the geodesic motion of S2 and G2 at Sagittarius A*, i.e. $m_{\rm core}=3.5\times 10^5 M_\odot$, and the rotation curve from~\citet{sofue_rotation_2013}.
As a first step, we fixed values for $\epsilon=56$ and
fixed the IC that was recently fitted for the NFW-MW model, in order to perform a genetic minimization of the
$\chi^2_{\rm{full}}$ function in the window:
$(\theta_0,\omega_0, \beta_0)\in [35, 40]\times[25, 30]\times[10^{-5}, 1.5\times10^{-5}]$. Using metaparameter values \texttt{maxiter}=\texttt{popsize}=400, the algorithm converged to
$(\theta_0, \omega_0, \beta_0)\approx (36.0665,27.3471 , 1.25713\times10^{-5})$
 with a value of $\chi^2_{\rm{stream}}\approx 21.9585$ and  $\chi^2_{\rm{core}}\approx 1.117$.
 Although the stream fit is good (as will later be shown), the associated value of the core mass was
 $m\approx 3.537\times 10^6 M\odot$ which implies that there is room for improvement.
We took this result to shrink the window to $(\theta_0,\omega_0, \beta_0)\in [35, 37]\times[26, 28]\times[1.2\times 10^{-5}, 1.3\times10^{-5}]$ and re-run the genetic algorith (second step), converging
to $(\theta_0, \omega_0, \beta_0)\approx (36.0661, 27.3468,1.25769\times10^{-5})$ with a value of $\chi^2_{\rm{stream}}\approx 21.9585$ and  $\chi^2_{\rm{core}}\approx 1.344\times10^{-5}$ which corresponds to
 a much precise value of the core mass, $m\approx 3.5001 M\odot$. It can be noticed the great sensitivity of the core mass depence on the model parameters because a change in the fifth significant digit of the parameters propagates to a change of in  the third significant digit of $m$. Nevertheless, both solutions above are astrophysically equivalent because~\citet{2021MNRAS.505L..64B} has prooved that core masses in the range $[3.5, 3.55]\times 10^6 M\odot$ give good fits of the S-stars.
Finally, the third step consisted in fixing the Fermionic-MW parameters while floating the ICs of the orbit with the genetic scheme, with metaparameter values \texttt{maxiter}=\texttt{popsize}=400, which gave us very similar to the FMW-MW case:
$\alpha=148.88^{\circ}$, $\delta=36.34^{\circ}$, $D=7.96$ kpc,
$\tilde{\mu}_\alpha=-6.87$ mas/yr, $\mu_\delta=-12.49$ mas/yr and $v_h=-16.05$ km/s.
The corresponding orbit is displayed in the observable space in Figs.~\ref{fig:obs_pos}-\ref{fig:obs_vel}~
with a dotted green line where it can be noticed that both the Fermionic-MW and NFW-MW models
fit the GD-1 stream very well.
We have not performed any statistically rigourous comparison between both models to determine which one is
more consistent with the data. In fact, here we used a fixed NFW-MW model that was fitted by~\citet{2019MNRAS.486.2995M} with another set of Gaia DR2 observations, as has previously been stated.\\
%
\begin{figure*}
   \centering
   \includegraphics[width=0.8\textwidth]{figures/observables_position.pdf}
   \includegraphics[width=0.8\textwidth]{figures/observables_heldist.pdf}
   \caption{Stream fits in observable space: sky position (top: $\phi_2$) and heliocentric distance (bottom: $D$).}
   \label{fig:obs_pos}
\end{figure*}
\begin{figure*}
   \includegraphics[width=0.8\textwidth]{figures/observables_pmra.pdf}
   \includegraphics[width=0.8\textwidth]{figures/observables_pmdec.pdf}
   \includegraphics[width=0.8\textwidth]{figures/observables_helvel.pdf}
   \caption{Stream fits in observable space: proper motion (top: $\tilde{\mu}_\alpha$, middle: $\mu_\delta$) and heliocentric velocity (bottom: $v_h$).}
   \label{fig:obs_vel}
\end{figure*}
%
We would like to give a glimpse of how badly behaved is the $\chi^2_{\rm{stream}}$ function so we have evaluated it for fixed values of $(\epsilon, \beta_0)=(56, 1.25\times10^{-5})$ in a bidimensional grid
spanning the box $(\theta_0, \omega_0)\in[35.25, 37.25]\times[26.5, 28.5]$.
Fig.~\ref{fig:chi2stream} shows this grid colored by the value of their corresponding $\chi^2_{\rm{stream}}$.
It can be noticed that the minimum values of the function are located along a thin and finite {\it valley}.
In fact, there is a series of local minimums along the valley, in such a way that looks like an inverted
{\it mountain range}.

\begin{figure}
   \centering
   \includegraphics[width=0.4\textwidth]{figures/observables_pmra.pdf}
   \caption{$\chi^2_{\rm{stream}}$ function for $(\epsilon, \beta_0)=(56, 1.25\times10^{-5})$ in
   the window $(\theta_0, \omega_0)\in[35.25, 37.25]\times[26.5, 28.5]$. It can be noticed that
   the minimum values of the function are located along a thin and finite {\it valley}.}
   \label{fig:chi2stream}
\end{figure}


\section{Conclusions}
\label{sec:conclusions}

%______________________________________________________________


\begin{acknowledgements}
    Thank to people, institutions and codes used.
    This work used computational resources from CCAD – Universidad Nacional de Córdoba (https://ccad.unc.edu.ar/), which are part of SNCAD – MinCyT, República Argentina.
    MFM thanks Juan Ignacio Rodriguez for his great support with hardware and
    software issues regarding the IALP server and personal computers.
    The figures presented where made with the
    {\it AlgebraOfGraphics.jl}~(https://aog.makie.org/dev/) and
    {\it Makie.jl}~\citep{DanischKrumbiegel2021}
    packages.
\end{acknowledgements}

% WARNING
%-------------------------------------------------------------------
% Please note that we have included the references to the file aa.dem in
% order to compile it, but we ask you to:
%
% - use BibTeX with the regular commands:
%   \bibliographystyle{aa} % style aa.bst
%   \bibliography{Yourfile} % your references Yourfile.bib
%
% - join the .bib files when you upload your source files
%-------------------------------------------------------------------
\bibliographystyle{aa} % style aa.bst
\bibliography{refs} % your references Yourfile.bib
%

\end{document}


